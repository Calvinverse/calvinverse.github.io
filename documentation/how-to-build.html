
<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="description" />
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Calvinverse - How to build</title>

        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
        <link href="/assets/css/scribbler-global.css" rel="stylesheet" />
                <link href="/assets/css/scribbler-doc.css" rel="stylesheet" />

        <meta name="application-name" content="Calvinverse" />
        <meta name="msapplication-tooltip" content="Calvinverse" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Calvinverse - How to build" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://calvinverse.github.io/documentation/how-to-build" />
        <!-- TODO: More social graph meta tags -->



        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
                <script src="/assets/js/html5shiv.js"></script>
                <script src="/assets/js/respond.min.js"></script>
        <![endif]-->

        <!-- Our scripts -->
<script src="/assets/js/script.js"></script><script src="/assets/js/scribbler.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3T5HLXMFTE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3T5HLXMFTE');
</script>

    </head>
    <body>
        <nav>
            <div class="logo"></div>
            <div class="menu">
                <ul>
            <li class="inactive" >
                <a href="/">Home</a>
            </li>
            <li class="active" >
                Documentation
            </li>
            <li class="inactive" >
                <a href="/resources">Resources</a>
            </li>
</ul>
            </div>
        </nav>


        <div class="wrapper">
                    <!-- Left side column. contains the logo and sidebar -->
                    <aside class="doc__nav">
                        <section>
                            
                            
                            <ul>

                <li><a href="/documentation/about">About</a></li>
                <li><a href="/documentation/configuration">Configuration</a></li>
                <li><a href="/documentation/setup">Environment setup</a></li>
                <li><a href="/documentation/environments">Environments - What and why?</a></li>
                <li><a href="/documentation/examples">Examples</a></li>
                <li><a href="/documentation/getting-started">Getting started</a></li>
                <li class="selected"><a href="/documentation/how-to-build">How to build</a></li>
                            </ul>
                            
                        </section>
                    </aside>

            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                
<div>
    <p><strong>Status: Thoughts only, needs proper formatting</strong></p>
<p><a href="https://github.com/Calvinverse/calvinverse.docs/issues/8">Issue #9</a></p>
<h1 id="how-to-build-the-resources">How to build the resources</h1>
<p>To create one of the resources</p>
<ul>
<li><p>The <a href="">NuGet command line executable</a> should be on the PATH</p>
</li>
<li><p>The <a href="">Git</a> executable should be on the PATH</p>
</li>
<li><p>MsBuild needs to be installed. Needs to be at least MsBuild 15 but higher is compatible</p>
</li>
<li><p>Need to have a storage place for ISO's and the resource files</p>
</li>
<li><p>Need a way to build things (i.e. a machine with a hypervisor)</p>
<ul>
<li>For Hyper-V you need to configure a virtual switch that allows the VMS to get to the internet
so that they can download all the required tooling. The name of this switch should be
given to packer via the configuration so that Packer can connect the VM to the correct switch</li>
<li>If the VMS are on their own ethernet interface then you can run into the Packer bug</li>
</ul>
</li>
<li><p>Using <a href="https://packer.io">Packer</a> to create VMs. By default everything is configured to work
with Hyper-V, but the Packer configuration can be adjusted to use a different hypervisor</p>
</li>
<li><p>Build the base resources first</p>
</li>
</ul>
<p>Once all the tools are installed you can start the build process with the following command line</p>
<pre><code>msbuild entrypoint.msbuild /t:build /P:IsoDirectory=&lt;PATH_TO_THE_APPROPRIATE_ISO_FILE&gt;
</code></pre>
<ul>
<li><p>How to build</p>
<ul>
<li>Using <a href="">nBuildKit</a> and <a href="">ops-tools-build</a> for the build scripts</li>
<li>Invoke the build generally with <code>msbuild entrypoint.msbuild /t:build</code> with additional properties</li>
<li>Should drop outputs in <code>build/deploy</code>. Generally a zip file with the Hyper-V files</li>
<li>Requirements
<ul>
<li>nuget.exe on the command line</li>
<li>Hyper-V installed and the user is a Hyper-V admin</li>
<li>Hyper-V switch with the correct name</li>
</ul>
</li>
</ul>
</li>
<li><p>How to test</p>
<ul>
<li>Smoke tests -&gt; <code>msbuild entrypoint.msbuild /t:test</code> -&gt; runs standard tests</li>
<li>Deploy into an environment, run tests</li>
</ul>
<h2 id="repositories">Repositories</h2>
</li>
<li><p>Configurations are stored in different repositories</p>
<ul>
<li>General configurations, mostly setting information for the different resources. While the environment
is running will be stored in the Consul key-value store. The original values are stored in the
<a href="">Calvinverse.Infrastructure</a> repository</li>
<li>Dashboards</li>
<li>Log filters</li>
<li>Elasticsearch index templates</li>
</ul>
</li>
<li><p>Ideally builds will be configured so that a change to the configuration will be tested and pushed
to a suitable test environment</p>
</li>
<li><p>Image repositories. Contain code to create the VM images. Work in progress to make them able to go
to Azure if necessary</p>
<ul>
<li>With some minor changes could also create images for AWS etc. Images are made using <a href="">Packer</a> so
anything packer can create can be made</li>
</ul>
</li>
</ul>
<p>... More details on how to build things go here ...</p>

</div>

            </div>
        </div>


        <footer>
            <div id="footer">
    <div id="fbox1">
        <h2>Related</h2>
        <ul>
            <li><a href="https://github.com/Calvinverse"><i class="fa fa-github"></i> GitHub</a></li>
        </ul>
    </div>
    <div id="fbox2">
        <h2 id="copyright">Copyright</h2>
        <p>Copyright (c) 2020 <a href="/">Petrik van der Velde</a>. All rights reserved.</p>

        <h2 id="disclaimer">Disclaimer</h2>
        <p>The opinions expressed herein are my own personal opinions and do not represent my employer's view in any way.</p>
    </div>
    <div id="fbox3">
        <h2 id="media">Media</h2>
        <p><a href="/feed.rss"><img src="/assets/img/feed.png" alt="RSS feed"></a></p>
    </div>
</div>
<div id="copyright">
    <p>
        Generated by <a href="https://wyam.io" class="link link--light">Wyam</a> on Fri, 30 Oct 2020 00:11:55 GMT

 from commit <a href="https://github.com/calvinverse/calvinverse.docs/tree/7632eaa664ff8bd94efb26e8f2065b269e4c35ad" class="link link--light">7632eaa664ff8bd94efb26e8f2065b269e4c35ad</a> at version 0.1.7.    </p>
</div>
        </footer>
    </body>
</html>